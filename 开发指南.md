# 港股美股打新记录小程序 - 开发指南

## 项目启动步骤

### 1. 环境准备
1. 下载并安装[微信开发者工具](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
2. 注册微信小程序账号（如需发布）

### 2. 项目导入
1. 打开微信开发者工具
2. 选择"导入项目"
3. 选择项目目录：`/Users/chenshijun/Documents/code/new_stocks`
4. 填写项目名称和AppID（测试可使用测试号）

### 3. 项目配置
- **app.json**: 小程序配置文件，包含页面路由、tabBar等配置
- **app.js**: 小程序入口文件，处理生命周期和全局数据
- **app.wxss**: 全局样式文件

### 4. 页面说明

#### 登录页面 (pages/login/)
- 处理微信用户授权登录
- 获取用户基本信息
- 引导用户进入主应用

#### 首页 (pages/index/)
- 显示用户信息和统计数据
- 展示进行中的打新记录
- 提供快速操作入口

#### 新增/编辑记录页面 (pages/add-stock/)
- 支持新增和编辑打新记录
- 表单验证和数据保存
- 只读模式展示详情

#### 中签结果录入 (pages/winning-result/)
- 录入中签股数和时间
- 实时计算中签金额和中签率
- 数据验证防止错误输入

#### 卖出记录 (pages/sell-record/)
- 录入卖出价格和相关费用
- 自动计算盈亏和收益率
- 支持结束打新状态

#### 历史记录 (pages/history/)
- 展示所有打新记录
- 支持时间和状态筛选
- 分页加载优化性能

## 开发注意事项

### 1. 数据存储
- 使用 `wx.setStorageSync()` 和 `wx.getStorageSync()` 进行本地数据存储
- 主要存储键名：
  - `userInfo`: 用户信息
  - `stocks`: 股票记录数组

### 2. 页面跳转
- 使用 `wx.navigateTo()` 进行页面跳转
- 使用 `wx.switchTab()` 切换tabBar页面
- 使用 `wx.navigateBack()` 返回上一页

### 3. 数据格式化
- 时间戳转换为可读日期格式
- 数字精度控制（金额保留2位小数）
- 港股美股区分处理

### 4. 用户体验
- 加载状态提示
- 错误信息友好显示
- 表单验证及时反馈

## API 说明

### 微信小程序 API
- `wx.login()`: 获取登录凭证
- `wx.getUserProfile()`: 获取用户信息
- `wx.showToast()`: 显示提示信息
- `wx.showModal()`: 显示模态对话框

### 自定义工具函数

#### 时间格式化
```javascript
formatDate(timestamp) {
  const date = new Date(timestamp)
  return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`
}
```

#### 盈亏计算
```javascript
calculateProfit(sellPrice, sellShares, costPrice, fees) {
  const sellAmount = sellPrice * sellShares
  const costAmount = costPrice * sellShares
  return sellAmount - costAmount - fees
}
```

## 样式规范

### 颜色主题
- 主色调：`#07c160` (微信绿)
- 辅助色：`#576b95` (微信蓝)
- 成功色：`#10b981` (绿色)
- 错误色：`#ef4444` (红色)
- 警告色：`#fdcb6e` (黄色)

### 间距规范
- 页面内边距：`30rpx`
- 元素间距：`20rpx`
- 卡片圆角：`20rpx`
- 按钮圆角：`15rpx`

### 字体大小
- 标题：`32rpx`
- 正文：`28rpx`
- 辅助文字：`24rpx`
- 小号文字：`22rpx`

## 测试说明

### 功能测试
1. 用户登录流程
2. 新增打新记录
3. 录入中签结果
4. 录入卖出信息
5. 数据修改和删除
6. 筛选和查询功能

### 兼容性测试
- iOS微信客户端
- Android微信客户端
- 不同屏幕尺寸适配

## 发布流程

1. **代码审查**：确保代码质量和规范
2. **功能测试**：完整测试所有功能
3. **版本打包**：在微信开发者工具中上传代码
4. **提交审核**：在微信公众平台提交审核
5. **发布上线**：审核通过后发布

## 维护更新

### 版本管理
- 遵循语义化版本号规范
- 记录每次更新的功能变更
- 保持向后兼容性

### 数据迁移
- 新版本发布时考虑数据结构变更
- 提供数据迁移方案
- 保证用户数据安全

## 技术支持

如有问题或建议，请通过以下方式联系：
- 邮箱：your-email@example.com
- 微信：your-wechat-id

---

**注意**：本项目仅供学习和个人使用，请遵守相关法律法规和微信小程序开发规范。
